# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the \"License\"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an \"AS IS\" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

Flow Controller:

  name: MiNiFi Flow
  id: 0f07e7aa-2586-46fd-87b2-80114f3232ef

Processors:

  - name: ListenHTTP
    id: 471deef6-2a6e-4a7d-912a-81cc17e3a206
    class: org.apache.nifi.processors.standard.ListenHTTP
    max concurrent tasks: 8
    scheduling strategy: TIMER_DRIVEN
    scheduling period: 1 sec
    penalization period: 30 sec
    yield period: 1 sec
    run duration nanos: 0
    auto-terminated relationships list: ['failure']
    Properties:
      Listening Port: 8080
      HTTP Headers to receive as Attributes (Regex): .*

  - name: RoutePackets
    id: 7eeeb4b1-faa1-4933-b9c8-e3eb4cc40c9a
    class: org.apache.nifi.processors.standard.RouteOnAttribute
    max concurrent tasks: 8
    scheduling strategy: EVENT_DRIVEN
    scheduling period: 1 sec
    penalization period: 30 sec
    yield period: 1 sec
    run duration nanos: 0
    auto-terminated relationships list: ['malwareDetected', 'Unmatched']
    Properties:
      maliciousActivity Attribute: 'malicious'
      benignTraffic Attribute: 'benign'

  - name: LogAttribute
    id: 9b466ef3-f120-451b-824c-bd8dc889cc9d
    class: org.apache.nifi.processors.standard.LogAttribute
    max concurrent tasks: 1
    scheduling strategy: EVENT_DRIVEN
    scheduling period: 1 sec
    penalization period: 30 sec
    yield period: 1 sec
    run duration nanos: 0
    auto-terminated relationships list: ['success', 'failure']

Connections:

  - name: TransferFilesToPacketRouter
    id: 1d347615-de75-4b94-b710-98f81bdf7c55
    source name: ListenHTTP
    source id: 471deef6-2a6e-4a7d-912a-81cc17e3a206
    source relationship name: success
    destination id: 7eeeb4b1-faa1-4933-b9c8-e3eb4cc40c9a
    max work queue size: 0
    max work queue data size: 1 MB
    flowfile expiration: 60 sec

  - name: TransferMaliciousToLogAttr
    id: 7be50b36-5ca1-48f3-a513-b63f59a7f629
    source name: RoutePackets
    source id: 7eeeb4b1-faa1-4933-b9c8-e3eb4cc40c9a
    source relationship name: maliciousActivity
    destination id: 9b466ef3-f120-451b-824c-bd8dc889cc9d
    max work queue size: 0
    max work queue data size: 1 MB
    flowfile expiration: 60 sec

  - name: TransferBenignToLogAttr
    id: c2655f4f-508a-4829-adfb-b47ea21faa26
    source name: RoutePackets
    source id: 7eeeb4b1-faa1-4933-b9c8-e3eb4cc40c9a
    source relationship name: benignTraffic
    destination id: 9b466ef3-f120-451b-824c-bd8dc889cc9d
    max work queue size: 0
    max work queue data size: 1 MB
    flowfile expiration: 60 sec

  - name: TransferUnmatchedToLogAttr
    id: 2996d2f3-2481-41e6-a7dc-6679d8edcdb6
    source name: RoutePackets
    source id: 7eeeb4b1-faa1-4933-b9c8-e3eb4cc40c9a
    source relationship name: Unmatched
    destination id: 9b466ef3-f120-451b-824c-bd8dc889cc9d
    max work queue size: 0
    max work queue data size: 1 MB
    flowfile expiration: 60 sec

Remote Processing Groups: []
